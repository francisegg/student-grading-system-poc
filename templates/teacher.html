<!DOCTYPE html>
<html>
<head>
    <title>ç®¡ç† - {{ .Subject }}</title>
    <link rel="icon" type="image/png" href="/static/cover_egg.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f8f9fa; margin: 0; color: #333; }
        .top-bar { background: #fff; padding: 15px 30px; border-bottom: 1px solid #e0e0e0; display: flex; align-items: center; justify-content: space-between; }
        .breadcrumb { display: flex; align-items: center; gap: 10px; font-size: 1.1rem; }
        .breadcrumb a { text-decoration: none; color: #5f6368; padding: 5px 10px; border-radius: 4px; transition: 0.2s; }
        .breadcrumb a:hover { background-color: #f1f3f4; color: #202124; }
        .current-subject { font-weight: bold; color: #1a73e8; background: #e8f0fe; padding: 5px 12px; border-radius: 20px; }
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; display: grid; grid-template-columns: 350px 1fr; gap: 30px; }
        .panel { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 20px; height: fit-content; }
        .panel h3 { margin-top: 0; color: #202124; border-bottom: 2px solid #f1f3f4; padding-bottom: 15px; font-size: 1.1rem; }
        .upload-section { margin-bottom: 30px; }
        .section-title { font-weight: bold; color: #444; margin-bottom: 5px; display: block; }
        .section-desc { font-size: 0.85em; color: #666; margin-bottom: 10px; line-height: 1.4; }
        .upload-area { border: 2px dashed #dadce0; border-radius: 8px; padding: 15px; text-align: center; margin-bottom: 10px; transition: 0.2s; background: #fafafa; }
        .upload-area:hover { border-color: #1a73e8; background: #f8faff; }
        .btn-primary { background: #1a73e8; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; width: 100%; font-size: 0.95rem; transition: 0.2s; font-weight: bold; }
        .btn-secondary { background: #2c3e50; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; width: 100%; font-size: 0.95rem; transition: 0.2s; font-weight: bold; }
        .btn-danger { background: white; color: #d93025; border: 1px solid #d93025; padding: 8px; width: 100%; border-radius: 4px; cursor: pointer; transition: 0.2s; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; border-radius: 8px; overflow: hidden; }
        th { background-color: #f8f9fa; color: #5f6368; text-align: left; padding: 15px; border-bottom: 2px solid #e0e0e0; }
        td { padding: 15px; border-bottom: 1px solid #f1f3f4; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="breadcrumb">
            <a href="/">ğŸ  èª²ç¨‹å¤§å»³</a>
            <span style="color:#dadce0">/</span>
            <span class="current-subject">{{ .Subject }}</span>
        </div>
        <div style="font-size: 0.9em; color: #5f6368;">
            ç›®å‰æ¨¡å¼: <b>{{ if .IsAdmin }}ğŸ‘¨â€ğŸ« ç®¡ç†å“¡å¾Œå°{{ else }}å–®ä¸€èª²ç¨‹å¾Œå°{{ end }}</b>
        </div>
    </div>

    <div class="container">
        <div class="panel">
            <h3>ğŸ› ï¸ èª²ç¨‹ç®¡ç†å·¥å…·</h3>
            <div class="upload-section">
                <span class="section-title">ğŸ“‹ æ­¥é©Ÿ 1ï¼šåŒ¯å…¥ä¿®èª²åå–®</span>
                <p class="section-desc">
                    è«‹ä¸Šå‚³å­¸ç”Ÿåå–®ã€‚<br>
                    CSV æ ¼å¼ï¼š<code>No., Class, ID</code>
                </p>
                <form action="/teacher/upload-roster" method="POST" enctype="multipart/form-data">
                    {{ if .IsAdmin }}<input type="hidden" name="subject" value="{{ .Subject }}">{{ end }}
                    <div class="upload-area">
                        <input type="file" name="roster_file" accept=".csv" required style="width: 100%;">
                    </div>
                    <button type="submit" class="btn-secondary">ğŸ“¤ ä¸Šå‚³åå–®</button>
                </form>
            </div>

            <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

            <div class="upload-section">
                <span class="section-title">ğŸ“Š æ­¥é©Ÿ 2ï¼šåŒ¯å…¥æˆç¸¾è³‡æ–™</span>
                <p class="section-desc">
                    CSV æ ¼å¼éœ€åŒ…å«ï¼š<code>ID</code> æ¬„ä½ã€‚
                </p>
                <form action="/teacher/upload" method="POST" enctype="multipart/form-data">
                    {{ if .IsAdmin }}<input type="hidden" name="subject" value="{{ .Subject }}">{{ end }}
                    <div class="upload-area">
                        <input type="file" name="csv_file" accept=".csv" required style="width: 100%;">
                    </div>
                    <button type="submit" class="btn-primary">ğŸš€ ä¸Šå‚³æˆç¸¾</button>
                </form>
            </div>

            <div class="danger-zone">
                <form action="/teacher/delete-all" method="POST" onsubmit="return confirm('ç¢ºå®šè¦æ¸…ç©ºå—ï¼Ÿ');">
                    {{ if .IsAdmin }}<input type="hidden" name="subject" value="{{ .Subject }}">{{ end }}
                    <button type="submit" class="btn-danger">ğŸ’£ æ¸…ç©ºæœ¬ç§‘ç›®æˆç¸¾</button>
                </form>
            </div>
        </div>

        <div style="flex: 1;">
            <h3>ğŸ“Š ç›®å‰æˆç¸¾åˆ—è¡¨ ({{ .Subject }})</h3>
            <table>
                <thead>
                    <tr>
                        <th>å­¸è™Ÿ (ID)</th>
                        <th>é …ç›®</th>
                        <th>åˆ†æ•¸</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range .AllGrades }}
                    <tr>
                        <td><b>{{ .StudentID }}</b></td>
                        <td>{{ .ItemName }}</td>
                        <td><b>{{ .Score }}</b></td>
                        <td>
                            <form action="/teacher/delete/{{.ID}}" method="POST" style="margin:0;">
                                <button type="submit">ğŸ—‘ï¸</button>
                            </form>
                        </td>
                    </tr>
                    {{ else }}
                    <tr><td colspan="4" style="text-align:center;">æš«ç„¡è³‡æ–™</td></tr>
                    {{ end }}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>